// Generated by LiveScript 1.6.0
(function(){
  var react, menuFuncs, naming, getPrimaryInfo, getLang, icon, navigate, get, find, CopyToClipboard, copiedInform, copy, minus, sendFuncs, icons, tokenMigration;
  react = require('react');
  menuFuncs = require('../menu-funcs.ls');
  naming = require('./naming.ls');
  getPrimaryInfo = require('../get-primary-info.ls');
  getLang = require('../get-lang.ls');
  icon = require('./icon.ls');
  navigate = require('../navigate.ls');
  get = require('../../web3t/providers/superagent.js').get;
  find = require('prelude-ls').find;
  CopyToClipboard = require('react-copy-to-clipboard').CopyToClipboard;
  copiedInform = require('../copied-inform.ls');
  copy = require('../copy.ls');
  minus = require('../math.ls').minus;
  sendFuncs = require('../send-funcs.ls');
  icons = require('../icons.ls');
  tokenMigration = function(store, web3t){
    var style, lang, btnIcon, inputStyle, color, styleTextarea, logoStyle, buttonPrimary2Style, buttonPrimary3Style, buttonPrimary4Style, filterIcon, gotoTerms, visibleMigrate, visibleMigrateAccept, visibleClass, hideClass, hide, visible, tryMigrate, swap, closeMigration, children;
    style = getPrimaryInfo(store);
    lang = getLang(store);
    btnIcon = {
      filter: style.app.btnIcon
    };
    inputStyle = {
      background: style.app.wallet,
      color: style.app.text
    };
    color = {
      color: style.app.text
    };
    styleTextarea = {
      background: style.app.wallet,
      color: style.app.text
    };
    logoStyle = {
      filter: style.app.filterLogo
    };
    buttonPrimary2Style = {
      border: "1px solid " + style.app.primary2,
      color: style.app.text,
      background: style.app.primary2,
      backgroundColor: style.app.primary2Spare
    };
    buttonPrimary3Style = {
      border: "1px solid " + style.app.border,
      color: style.app.text2,
      background: style.app.primary3,
      backgroundColor: style.app.primary3Spare
    };
    buttonPrimary4Style = {
      border: "1px solid " + style.app.border,
      color: style.app.text,
      background: 'rgb(195, 92, 95)'
    };
    filterIcon = {
      filter: style.app.filterIcon
    };
    gotoTerms = function(){
      return navigate(store, web3t, 'terms2');
    };
    visibleMigrate = function(){
      return store.current.contentMigrate = !store.current.contentMigrate;
    };
    visibleMigrateAccept = function(){
      return store.current.acceptMigrate = !store.current.acceptMigrate;
    };
    visibleClass = store.current.contentMigrate ? 'visible' : 'hide';
    hideClass = store.current.contentMigrate ? 'hide' : "";
    hide = store.current.acceptMigrate ? 'hide' : "";
    visible = store.current.acceptMigrate ? 'visible' : "";
    tryMigrate = function(trials, amount, cb){
      var address;
      if (trials <= 0) {
        return cb("You coins can't be transferred by automatic script please contact support in https://t.me/velasmigration for additional verification.");
      }
      address = function(it){
        return it.address;
      }(
      find(function(it){
        return it.coin.token === 'vlx2';
      })(
      store.current.account.wallets));
      return get("https://mainnet-v2.velas.com/migration/try-migrate/" + address).end(function(err){
        return setTimeout(function(){
          return web3t.refresh(function(){
            var amount2, trialsNext;
            amount2 = function(it){
              return it.balance;
            }(
            find(function(it){
              return it.coin.token === 'vlx2';
            })(
            store.current.account.wallets));
            if (amount !== amount2) {
              return cb(null);
            }
            trialsNext = trials - 1;
            if (err != null) {
              return tryMigrate(trialsNext, amount, cb);
            }
            return cb(null);
          });
        }, 5000);
      });
    };
    swap = function(){
      var amount, amount2, to;
      amount = function(it){
        return it.balance;
      }(
      find(function(it){
        return it.coin.token === 'vlx';
      })(
      store.current.account.wallets));
      amount2 = (function(){
        switch (false) {
        case store.urlParams.internal == null:
          return 1;
        default:
          return minus(amount, 0.01);
        }
      }());
      to = store.current.tokenMigration;
      store.current.tokenMigration = null;
      return web3t.vlx.sendTransaction({
        to: to,
        amount: amount2
      }, function(err){
        var amount2;
        if (err != null) {
          return alert(err + "");
        }
        amount2 = function(it){
          return it.balance;
        }(
        find(function(it){
          return it.coin.token === 'vlx2';
        })(
        store.current.account.wallets));
        if (err != null) {
          return alert(err + "");
        }
        return cb(null);
      });
    };
    closeMigration = menuFuncs(store, web3t).closeMigration;
    return react.createElement('div', {}, children = react.createElement('div', {
      className: 'section last'
    }, children = react.createElement('div', {
      style: color,
      className: 'description'
    }, children = [
      react.createElement('div', {
        className: hideClass + " terms-migrate"
      }, children = [
        react.createElement('div', {
          className: 'migrate-img'
        }, children = react.createElement('img', {
          src: style.branding.logo + "",
          style: logoStyle,
          className: 'iron'
        })), react.createElement('div', {
          className: 'terms-body'
        }, children = [
          react.createElement('div', {
            className: 'header'
          }, ' Terms of Swap'), react.createElement('textarea', {
            value: store.terms2 + "",
            style: styleTextarea
          }), react.createElement('form', {}, children = [
            react.createElement('input', {
              type: 'checkbox'
            }), react.createElement('span', {}, ' I accept and agree to the Terms & Conditions relating to the Velas Token Swap.')
          ])
        ]), react.createElement('div', {
          className: 'content'
        }, children = [
          react.createElement('button', {
            onClick: visibleMigrate,
            style: buttonPrimary3Style
          }, children = react.createElement('span', {}, children = [
            react.createElement('img', {
              src: icons.accept + "",
              style: btnIcon,
              className: 'icon-svg'
            }), " Accept"
          ])), react.createElement('button', {
            onClick: closeMigration,
            style: buttonPrimary4Style
          }, children = react.createElement('span', {}, children = [
            react.createElement('img', {
              src: icons.deny + "",
              className: 'icon-svg'
            }), " Deny"
          ]))
        ])
      ]), react.createElement('div', {
        className: (visibleClass + ' ' + hide) + " terms-migrate"
      }, children = [
        react.createElement('div', {
          className: 'migrate-img'
        }, children = react.createElement('img', {
          src: style.branding.logo + "",
          style: logoStyle,
          className: 'iron'
        })), react.createElement('div', {
          className: 'terms-body'
        }, children = [
          react.createElement('div', {
            className: 'header'
          }, ' Confirm to continue'), react.createElement('form', {}, children = [
            react.createElement('input', {
              type: 'checkbox'
            }), react.createElement('span', {}, children = [
              react.createElement('span', {
                className: 'orange'
              }, ' I am not:'), react.createElement('ol', {
                type: 'I'
              }, children = [
                react.createElement('li', {
                  key: "one"
                }, ' a citizen or resident of, or domiciled in;'), react.createElement('li', {
                  key: "two"
                }, ' participating in the token swap from a location in;'), react.createElement('li', {
                  key: "three"
                }, ' representing or acting on behalf of a person residing or located in,'), react.createElement('li', {
                  key: "four"
                }, ' representing or acting on behalf of an entity (including, but not limited to, any company or partnership) incorporated, established or registered in or under the laws of: the United States of America (USA) and its territories (American Samoa, Guam, the Northern Mariana Islands, Puerto Rico, and the U.S. Virgin Islands), Peoples Republic of China (except for Hong Kong and Macao), Cuba, Democratic Republic of Congo, Iran, Iraq, Malaysia, North Korea, Sudan, Syria, Zimbabwe.')
              ])
            ])
          ])
        ]), react.createElement('div', {
          className: 'content'
        }, children = [
          react.createElement('button', {
            onClick: visibleMigrateAccept,
            style: buttonPrimary3Style
          }, children = react.createElement('span', {}, children = [
            react.createElement('img', {
              src: icons.accept + "",
              style: btnIcon,
              className: 'icon-svg'
            }), " Accept"
          ])), react.createElement('button', {
            onClick: closeMigration,
            style: buttonPrimary4Style
          }, children = react.createElement('span', {}, children = [
            react.createElement('img', {
              src: icons.deny + "",
              className: 'icon-svg'
            }), " Deny"
          ]))
        ])
      ]), react.createElement('div', {
        className: visible + " content-migrate"
      }, children = [
        react.createElement('img', {
          src: icons.migrateImg + ""
        }), react.createElement('div', {}, ' Swap all your coins automatically.'), react.createElement('div', {
          className: 'content'
        }, children = react.createElement('button', {
          onClick: swap,
          style: buttonPrimary2Style
        }, children = react.createElement('span', {}, children = [
          react.createElement('img', {
            src: icons.swap + "",
            className: 'icon'
          }), " Swap Coins"
        ]))), react.createElement('div', {
          className: 'support'
        }, children = [
          " Support: ", react.createElement('a', {
            href: "https://t.me/velasmigration",
            target: "_blank"
          }, ' t.me/velasmigration')
        ])
      ])
    ])));
  };
  module.exports = function(arg$){
    var store, web3t, closeMigration, style, accountBodyStyle, borderStyle, lang, children;
    store = arg$.store, web3t = arg$.web3t;
    if (store.current.tokenMigration == null) {
      return null;
    }
    closeMigration = menuFuncs(store, web3t).closeMigration;
    style = getPrimaryInfo(store);
    accountBodyStyle = {
      background: style.app.background,
      backgroundColor: style.app.bgspare,
      color: style.app.text
    };
    borderStyle = {
      background: style.app.header,
      color: style.app.text
    };
    lang = getLang(store);
    return react.createElement('div', {
      className: 'manage-account manage-account617040762'
    }, children = react.createElement('div', {
      style: accountBodyStyle,
      className: 'account-body'
    }, children = [
      react.createElement('div', {
        style: borderStyle,
        className: 'title'
      }, children = [
        react.createElement('div', {
          className: 'header'
        }, ' Token Migration'), react.createElement('div', {
          onClick: closeMigration,
          className: 'close'
        }, children = icon('X', 20))
      ]), react.createElement('div', {
        className: 'settings'
      }, children = tokenMigration(store, web3t))
    ]));
  };
}).call(this);
